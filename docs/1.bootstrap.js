(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(e,t,r){"use strict";r.r(t);var n=r(2),o=r(3);const i=document.getElementById("tetrust-canvas"),a=i.getContext("webgl");if(null===a){const e="Unable to initialize WebGL. Your browser or machine may not support it.";throw alert(e),new Error(e)}if(!a.getExtension("OES_texture_float")){const e="no floating point texture support";throw alert(e),new Error(e)}let u=NaN,c=NaN;window.onresize=v,v(),i.onmousemove=(e=>{n.e(performance.now(),e.x,e.y)}),i.onmousedown=(e=>{n.d(performance.now(),e.x,e.y)}),i.onmouseup=(e=>{n.f(performance.now(),e.x,e.y)});{const e=document.getElementsByTagName("BODY")[0];e.onkeydown=(e=>{e.repeat||n.b(performance.now(),e.keyCode,e.key)}),e.onkeyup=(e=>{n.c(performance.now(),e.keyCode,e.key)})}window.addEventListener("gamepadconnected",function(e){console.log("Gamepad connected at index %d: %s. %d buttons, %d axes.",e.gamepad.index,e.gamepad.id,e.gamepad.buttons.length,e.gamepad.axes.length)});const s=a.createProgram();if(a.attachShader(s,N(a,a.VERTEX_SHADER,"\n      attribute vec4 a_vertex_position;\n      attribute vec2 a_tile_map_coord;\n\n      uniform mat4 u_clip_matrix;\n\n      varying highp vec2 vTileMapCoord;\n\n      void main() {\n        gl_Position = u_clip_matrix * a_vertex_position;\n        vTileMapCoord = a_tile_map_coord;\n      }\n    ")),a.attachShader(s,N(a,a.FRAGMENT_SHADER,"\n      precision highp float;\n      varying vec2 vTileMapCoord;\n\n      uniform sampler2D u_tiles;\n      uniform sampler2D u_tile_map;\n      uniform sampler2D u_src_to_origin;\n      uniform sampler2D u_origin_to_dest;\n\n      uniform mat2 u_scale;\n\n      void main() {\n        gl_FragColor = texture2D(\n          u_tiles,\n          u_scale * (vTileMapCoord + texture2D(u_src_to_origin, vTileMapCoord).xy) +\n            texture2D(u_origin_to_dest, vec2(texture2D(u_tile_map, vTileMapCoord).a)).xy\n        );\n      }\n    ")),a.linkProgram(s),!a.getProgramParameter(s,a.LINK_STATUS)){const e="Unable to initialize the shader program: "+a.getProgramInfoLog(s);throw alert(e),new Error(e)}{a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer()),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,1,1,1,1,0,0,0]),a.STATIC_DRAW);const e=a.getAttribLocation(s,"a_tile_map_coord");a.vertexAttribPointer(e,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(e)}a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,a.createBuffer()),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,3]),a.STATIC_DRAW);const l=a.createTexture();{a.bindTexture(a.TEXTURE_2D,l),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array([228,92,16,255])),B(a);const e=new Image;e.onload=(()=>{a.bindTexture(a.TEXTURE_2D,l),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),B(a),function e(t){S=t;const r=n.g(t,u,c);if(r.changed||r.grid_width!==D||r.grid_height!==b)try{if(a.useProgram(s),r.grid_width!==D||r.grid_height!==b){D=r.grid_width,b=r.grid_height;const e=[];for(let t=0;t<b;t+=1)for(let r=0;r<D;r+=1)e.push(-r/D),e.push(-t/b),e.push(0);y=[D/f,0,0,b/g],a.bindTexture(a.TEXTURE_2D,d),a.texImage2D(a.TEXTURE_2D,0,a.RGB,D,b,0,a.RGB,a.FLOAT,new Float32Array(e)),B(a),a.bindBuffer(a.ARRAY_BUFFER,p),a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,D,0,D,b,0,b]),a.STATIC_DRAW),a.vertexAttribPointer(E,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(E)}a.bindTexture(a.TEXTURE_2D,_),a.pixelStorei(a.UNPACK_ALIGNMENT,1),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,D,b,0,a.ALPHA,a.UNSIGNED_BYTE,new Uint8Array(o.o.buffer,r.grid,D*b)),B(a),a.uniformMatrix4fv(m,!1,new Float32Array(o.o.buffer,r.clip_matrix,16)),i(a,0,A,l),i(a,1,R,_),i(a,2,x,d),i(a,3,w,h),a.uniformMatrix2fv(U,!1,y),a.drawElements(a.TRIANGLE_FAN,4,a.UNSIGNED_SHORT,0)}catch(e){console.log(e)}function i(e,t,r,n){e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,n),e.uniform1i(r,t)}requestAnimationFrame(e)}(performance.now())}),e.src="Tiles.png"}const _=a.createTexture(),d=a.createTexture(),f=16,g=16,T=f*g,h=a.createTexture();{const e=[];for(let t=0;t<g;t+=1)for(let r=0;r<f;r+=1)e.push(r/f),e.push(t/g),e.push(0);a.bindTexture(a.TEXTURE_2D,h),a.texImage2D(a.TEXTURE_2D,0,a.RGB,T,1,0,a.RGB,a.FLOAT,new Float32Array(e)),B(a)}const p=a.createBuffer();a.useProgram(s);const E=a.getAttribLocation(s,"a_vertex_position"),m=a.getUniformLocation(s,"u_clip_matrix"),A=a.getUniformLocation(s,"u_tiles"),R=a.getUniformLocation(s,"u_tile_map"),w=a.getUniformLocation(s,"u_origin_to_dest"),x=a.getUniformLocation(s,"u_src_to_origin"),U=a.getUniformLocation(s,"u_scale");let D=NaN,b=NaN,y=[1,0,0,1],S=performance.now();function v(){const e=window.devicePixelRatio,t=Math.floor(i.clientWidth*e),r=Math.floor(i.clientHeight*e);i.width===t&&i.height===r||(u=t,c=r,i.width=t,i.height=r,a.viewport(0,0,t,r))}function B(e){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}function N(e,t,r){const n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){const t="An error occurred compiling the shaders: "+e.getShaderInfoLog(n);throw e.deleteShader(n),alert(t),new Error(t)}return n}},function(e,t,r){"use strict";r.d(t,"g",function(){return o}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return _}),r.d(t,"e",function(){return d}),r.d(t,"d",function(){return f}),r.d(t,"f",function(){return g}),r.d(t,"a",function(){return h});var n=r(3);Object.freeze({A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,ExclaimationMark:26,QuotationMark:27,PoundSign:28,DollarSign:29,Percent:30,Period:31,Zero:32,One:33,Two:34,Three:35,Four:36,Five:37,Six:38,Seven:39,Eight:40,Nine:41,Hyphen:42,Asterisk:43,LessThan:44,GreaterThan:45,Underscore:46,Slash:47,Apostrophe:48,OpenParentheses:49,CloseParentheses:50,OpenSquareBrace:51,CloseSquareBrace:52,OpenCurlyBrace:53,CloseCurlyBrace:54,QuestionMark:55,Colon:56,Semicolon:57,Bar:58,Comma:59,Plus:60,EqualSign:61,Block:62,Space:63,GreySolid:64,GreyWhite:65,GreenSolid:80,GreenWhite:81,CyanSolid:96,CyanWhite:97,BlueSolid:112,BlueWhite:113,VioletSolid:128,VioletWhite:129});function o(e,t,r){return p.__wrap(n.u(e,t,r))}let i,a=0,u=new TextEncoder("utf-8"),c=null;function s(){return null!==c&&c.buffer===n.o.buffer||(c=new Uint8Array(n.o.buffer)),c}function l(e,t,r){const o=i(r),u=a;try{return n.p(e,t,o,u)}finally{n.l(o,1*u)}}function _(e,t,r){const o=i(r),u=a;try{return n.q(e,t,o,u)}finally{n.l(o,1*u)}}function d(e,t,r){return n.s(e,t,r)}function f(e,t,r){return n.r(e,t,r)}function g(e,t,r){return n.t(e,t,r)}i="function"==typeof u.encodeInto?function(e){let t=e.length,r=n.m(t),o=0;for(;;){const i=s().subarray(r+o,r+t),{read:a,written:c}=u.encodeInto(e,i);if(o+=c,a===e.length)break;e=e.substring(a),r=n.n(r,t,t+=3*e.length)}return a=o,r}:function(e){const t=u.encode(e),r=n.m(t.length);return s().set(t,r),a=t.length,r};let T=new TextDecoder("utf-8");function h(e,t){throw new Error(function(e,t){return T.decode(s().subarray(e,e+t))}(e,t))}class p{static __wrap(e){const t=Object.create(p.prototype);return t.ptr=e,t}free(){const e=this.ptr;this.ptr=0,function(e){n.f(e)}(e)}get changed(){return 0!==n.a(this.ptr)}set changed(e){return n.g(this.ptr,e)}get clip_matrix(){return n.b(this.ptr)}set clip_matrix(e){return n.h(this.ptr,e)}get grid_width(){return n.e(this.ptr)>>>0}set grid_width(e){return n.k(this.ptr,e)}get grid_height(){return n.d(this.ptr)>>>0}set grid_height(e){return n.j(this.ptr,e)}get grid(){return n.c(this.ptr)}set grid(e){return n.i(this.ptr,e)}}const E=new Array(32);E.fill(void 0),E.push(void 0,null,!0,!1);E.length},function(e,t,r){"use strict";var n=r.w[e.i];e.exports=n;r(2);n.v()}]]);